{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/personal-profile.schema.json",
  "title": "Personal Profile Schema",
  "description": "Schema for user profile configuration in the personal assistant system",
  "type": "object",
  "properties": {
    "_meta": {
      "type": "object",
      "description": "Metadata about this profile file",
      "properties": {
        "purpose": { "type": "string" },
        "instructions": { "type": "string" },
        "format": { "type": "string" },
        "referenced_via": { "type": "string" },
        "last_updated": { "type": "string", "description": "Last update date in YYYY-MM-DD format" }
      }
    },
    "_notes": {
      "type": "object",
      "description": "Notes and instructions for filling out the profile",
      "properties": {
        "required_fields": {
          "type": "array",
          "items": { "type": "string" }
        },
        "optional_fields": { "type": "string" },
        "customization": { "type": "string" },
        "privacy": { "type": "string" }
      }
    },
    "identity": {
      "type": "object",
      "description": "User identity and contact information",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "User's full name"
        },
        "location": {
          "type": "object",
          "properties": {
            "city": { "type": "string" },
            "region": { "type": "string" },
            "country": { "type": "string" }
          }
        },
        "contact": {
          "type": "object",
          "properties": {
            "address": { "type": "string" },
            "phone_primary": { "type": "string" },
            "phone_secondary": { "type": "string" },
            "_comment_phone_secondary": { "type": "string" },
            "email": {
              "type": "string",
              "format": "email"
            }
          }
        }
      }
    },
    "neurotype": {
      "type": "object",
      "description": "Cognitive profile, strengths, and challenges",
      "properties": {
        "_comment": { "type": "string" },
        "label": {
          "type": "string",
          "description": "Neurotype label (e.g., Neurotypical, ADHD, Autism, AuDHD, Dyslexia)"
        },
        "_comment_label": { "type": "string" },
        "description": { "type": "string" },
        "strengths": {
          "type": "array",
          "description": "Cognitive strengths with detailed descriptions",
          "items": {
            "type": "object",
            "required": ["label"],
            "properties": {
              "label": {
                "type": "string",
                "description": "Name/label of the strength"
              },
              "description": {
                "type": "string",
                "description": "Detailed description of this strength"
              },
              "assistant_response": {
                "type": "string",
                "description": "How the assistant should leverage this strength"
              }
            }
          }
        },
        "challenges": {
          "type": "array",
          "description": "Specific challenges and assistant response strategies",
          "items": {
            "type": "object",
            "required": ["label", "description", "assistant_response"],
            "properties": {
              "label": {
                "type": "string",
                "description": "Name/label of the challenge (e.g., task_initiation, context_switching)"
              },
              "description": {
                "type": "string",
                "description": "Brief description of the challenge"
              },
              "details": {
                "type": "string",
                "description": "Additional details about the challenge"
              },
              "assistant_response": {
                "type": "string",
                "description": "How the assistant should adapt to help with this challenge"
              }
            }
          }
        },
        "effective_strategies": {
          "type": "array",
          "items": { "type": "string" }
        },
        "core_principle": { "type": "string" }
      }
    },
    "time_definitions": {
      "type": "object",
      "description": "Configurable time periods - used across energy planning and scheduling",
      "required": ["morning", "noon", "afternoon", "evening", "night"],
      "properties": {
        "_comment": {
          "type": "string",
          "description": "These time definitions are personal - what 'morning' means varies by person"
        },
        "morning": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": { "type": "string", "description": "Start time in HH:MM format" },
            "end": { "type": "string", "description": "End time in HH:MM format" }
          }
        },
        "noon": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": { "type": "string", "description": "Start time in HH:MM format" },
            "end": { "type": "string", "description": "End time in HH:MM format" }
          }
        },
        "afternoon": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": { "type": "string", "description": "Start time in HH:MM format" },
            "end": { "type": "string", "description": "End time in HH:MM format" }
          }
        },
        "evening": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": { "type": "string", "description": "Start time in HH:MM format" },
            "end": { "type": "string", "description": "End time in HH:MM format" }
          }
        },
        "night": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": { "type": "string", "description": "Start time in HH:MM format" },
            "end": { "type": "string", "description": "End time in HH:MM format" }
          }
        }
      }
    },
    "energy_pattern": {
      "type": "object",
      "description": "Energy levels configuration - reported during check-ins for dynamic planning",
      "required": ["high", "medium", "low"],
      "properties": {
        "_comment": { "type": "string" },
        "high": {
          "type": "object",
          "required": ["label"],
          "properties": {
            "label": {
              "type": "string",
              "description": "Label for high energy state"
            },
            "description": {
              "type": "string",
              "description": "Description of what high energy feels like for the user"
            },
            "activities": {
              "type": "object",
              "description": "Activities suitable for high energy state, keyed by activity identifier",
              "patternProperties": {
                "^[a-z_]+$": {
                  "type": "object",
                  "required": ["label", "description", "preferred_time"],
                  "properties": {
                    "label": {
                      "type": "string",
                      "description": "Human-readable activity name"
                    },
                    "description": {
                      "type": "string",
                      "description": "What this activity involves for this specific user"
                    },
                    "preferred_time": {
                      "type": "string",
                      "enum": ["morning", "noon", "afternoon", "evening", "night"],
                      "description": "Preferred time of day for this activity"
                    }
                  }
                }
              }
            }
          }
        },
        "medium": {
          "type": "object",
          "required": ["label"],
          "properties": {
            "label": {
              "type": "string",
              "description": "Label for medium energy state"
            },
            "description": {
              "type": "string",
              "description": "Description of what medium energy feels like for the user"
            },
            "activities": {
              "type": "object",
              "description": "Activities suitable for medium energy state, keyed by activity identifier",
              "patternProperties": {
                "^[a-z_]+$": {
                  "type": "object",
                  "required": ["label", "description", "preferred_time"],
                  "properties": {
                    "label": {
                      "type": "string",
                      "description": "Human-readable activity name"
                    },
                    "description": {
                      "type": "string",
                      "description": "What this activity involves for this specific user"
                    },
                    "preferred_time": {
                      "type": "string",
                      "enum": ["morning", "noon", "afternoon", "evening", "night"],
                      "description": "Preferred time of day for this activity"
                    }
                  }
                }
              }
            }
          }
        },
        "low": {
          "type": "object",
          "required": ["label"],
          "properties": {
            "label": {
              "type": "string",
              "description": "Label for low energy state"
            },
            "description": {
              "type": "string",
              "description": "Description of what low energy feels like for the user"
            },
            "activities": {
              "type": "object",
              "description": "Activities suitable for low energy state, keyed by activity identifier",
              "patternProperties": {
                "^[a-z_]+$": {
                  "type": "object",
                  "required": ["label", "description", "preferred_time"],
                  "properties": {
                    "label": {
                      "type": "string",
                      "description": "Human-readable activity name"
                    },
                    "description": {
                      "type": "string",
                      "description": "What this activity involves for this specific user"
                    },
                    "preferred_time": {
                      "type": "string",
                      "enum": ["morning", "noon", "afternoon", "evening", "night"],
                      "description": "Preferred time of day for this activity"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "roles": {
      "type": "object",
      "description": "User's different roles and areas of life, keyed by numeric ID matching database",
      "properties": {
        "_comment": { "type": "string" }
      },
      "patternProperties": {
        "^[0-9]+$": {
          "type": "object",
          "required": ["label", "type", "id"],
          "properties": {
            "label": {
              "type": "string",
              "description": "Title of the role"
            },
            "type": {
              "type": "string",
              "enum": ["meta", "work", "personal", "private", "civic", "side_business", "hobby"],
              "description": "Role category - helps assistant understand scope"
            },
            "description": {
              "type": "string",
              "description": "What this role involves"
            },
            "id": {
              "type": "integer",
              "description": "Database ID for syncing - must match key"
            },
            "status": {
              "type": "string",
              "enum": ["active", "inactive", "historical"],
              "description": "Current status of the role"
            },
            "balance_target": {
              "type": "number",
              "description": "Target percentage for this role in weekly time distribution"
            },
            "notes": {
              "type": "string",
              "description": "Additional notes, e.g., when the role was left or paused"
            }
          }
        }
      }
    },
    "balance_targets": {
      "type": "object",
      "description": "Target distribution of time/energy across role categories",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "Overall targets by role type - individual role targets set in roles section"
        },
        "weekly_distribution": {
          "type": "object",
          "description": "Percentage or hours per week for each role category",
          "patternProperties": {
            "^[a-z_]+$": { "type": "number" }
          }
        }
      }
    },
    "values": {
      "type": "object",
      "description": "Core values, positions, and work principles",
      "properties": {
        "core": {
          "type": "array",
          "items": { "type": "string" }
        },
        "positions": {
          "type": "array",
          "items": { "type": "string" }
        },
        "work_principles": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "tools": {
      "type": "object",
      "description": "Tools the user works with - helps assistant understand workflow context",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "Each tool entry describes what it is and how the user employs it"
        }
      },
      "patternProperties": {
        "^[a-z_]+$": {
          "type": "object",
          "required": ["name", "purpose", "category"],
          "properties": {
            "name": {
              "type": "string",
              "description": "Tool name"
            },
            "purpose": {
              "type": "string",
              "description": "What the tool is used for"
            },
            "category": {
              "type": "string",
              "description": "Tool category (e.g., communication, development, pkm, productivity)"
            },
            "example_usage": {
              "type": "string",
              "description": "Concrete example of how user employs this tool"
            }
          }
        }
      }
    },
    "background": {
      "type": "object",
      "description": "Background information for context - CV-like structure",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "All entries use common attributes: name, start, end, description. Professional entries also include responsibilities and related_competencies."
        },
        "education": {
          "type": "array",
          "description": "Educational background",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": { "type": "string", "description": "Institution or program name" },
              "start": { "type": "string", "description": "Start date (YYYY or YYYY-MM)" },
              "end": { "type": "string", "description": "End date (YYYY or YYYY-MM), or 'present'" },
              "description": { "type": "string", "description": "What was studied or achieved" }
            }
          }
        },
        "professional": {
          "type": "array",
          "description": "Professional experience",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": { "type": "string", "description": "Position or company name" },
              "start": { "type": "string", "description": "Start date (YYYY or YYYY-MM)" },
              "end": { "type": "string", "description": "End date (YYYY or YYYY-MM), or 'present'" },
              "description": { "type": "string", "description": "Role description" },
              "responsibilities": {
                "type": "array",
                "items": { "type": "string" },
                "description": "Key responsibilities"
              },
              "related_competencies": {
                "type": "array",
                "items": { "type": "string" },
                "description": "Skills and competencies developed"
              }
            }
          }
        },
        "certifications": {
          "type": "array",
          "description": "Certifications and credentials",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": { "type": "string", "description": "Certification name" },
              "obtained": { "type": "string", "description": "Date obtained (YYYY or YYYY-MM)" },
              "valid_until": { "type": "string", "description": "Expiry date if applicable" },
              "description": { "type": "string", "description": "What the certification covers" }
            }
          }
        },
        "competencies": {
          "type": "array",
          "description": "Skills and competencies",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Competency name"
              },
              "description": {
                "type": "string",
                "description": "What this competency involves"
              },
              "level": {
                "type": "integer",
                "minimum": 1,
                "maximum": 5,
                "description": "Proficiency level 1-5 (5 = expert, optional)"
              },
              "category": {
                "type": "string",
                "description": "Category (e.g., technical, leadership, domain)"
              }
            }
          }
        },
        "languages": {
          "type": "array",
          "description": "Language proficiencies",
          "items": {
            "type": "object",
            "required": ["name", "level"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Language name"
              },
              "level": {
                "type": "integer",
                "minimum": 1,
                "maximum": 5,
                "description": "Proficiency level 1-5 (5 = native/fluent)"
              }
            }
          }
        },
        "memberships": {
          "type": "array",
          "description": "Professional memberships and affiliations",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Organization name"
              },
              "description": {
                "type": "string",
                "description": "Role or involvement"
              }
            }
          }
        }
      }
    },
    "learning_observations": {
      "type": "object",
      "description": "Patterns AIDA has observed about the user over time",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "AIDA learns patterns from journal entries and task completion to improve suggestions"
        },
        "observations": {
          "type": "array",
          "description": "Individual observations with evidence and confidence scores",
          "items": {
            "type": "object",
            "required": ["id", "category", "pattern", "confidence", "first_observed", "status"],
            "properties": {
              "id": {
                "type": "string",
                "description": "Unique identifier for the observation (UUID)"
              },
              "category": {
                "type": "string",
                "enum": ["energy", "time_preference", "role_focus", "task_completion", "work_style", "communication", "other"],
                "description": "Category of the observed pattern"
              },
              "pattern": {
                "type": "string",
                "description": "Human-readable description of the observed pattern"
              },
              "evidence": {
                "type": "array",
                "items": { "type": "string" },
                "description": "Specific examples that support this observation"
              },
              "confidence": {
                "type": "number",
                "minimum": 0,
                "maximum": 1,
                "description": "Confidence level (0.0-1.0) based on evidence count and consistency"
              },
              "first_observed": {
                "type": "string",
                "description": "ISO 8601 date when pattern was first noticed"
              },
              "last_confirmed": {
                "type": "string",
                "description": "ISO 8601 date when pattern was last confirmed"
              },
              "suggested_update": {
                "type": "object",
                "description": "Suggested profile change based on this observation",
                "properties": {
                  "path": {
                    "type": "string",
                    "description": "Dot-notation path to update (e.g., 'energy_pattern.high.activities.deep_work.preferred_time')"
                  },
                  "value": {
                    "description": "Suggested new value"
                  },
                  "rationale": {
                    "type": "string",
                    "description": "Why this change is suggested"
                  }
                }
              },
              "status": {
                "type": "string",
                "enum": ["active", "applied", "dismissed"],
                "description": "Current status: active (pending), applied (integrated), dismissed (rejected by user)"
              }
            }
          }
        }
      }
    },
    "feedback_history": {
      "type": "object",
      "description": "History of AIDA's suggestions and user responses for learning preferences",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "Track what types of suggestions work well for this user"
        },
        "suggestions": {
          "type": "array",
          "description": "Individual suggestions made by AIDA",
          "items": {
            "type": "object",
            "required": ["id", "type", "suggestion", "timestamp", "outcome"],
            "properties": {
              "id": {
                "type": "string",
                "description": "Unique identifier for the suggestion"
              },
              "type": {
                "type": "string",
                "enum": ["task_suggestion", "energy_match", "role_assignment", "time_recommendation", "profile_update", "activation_technique"],
                "description": "Type of suggestion made"
              },
              "suggestion": {
                "type": "string",
                "description": "What was suggested"
              },
              "context": {
                "type": "string",
                "description": "Context when suggestion was made (time, energy level, current work, etc.)"
              },
              "timestamp": {
                "type": "string",
                "description": "ISO 8601 datetime when suggestion was made"
              },
              "outcome": {
                "type": "string",
                "enum": ["accepted", "modified", "rejected", "ignored", "pending"],
                "description": "User's response to the suggestion"
              },
              "user_feedback": {
                "type": "string",
                "description": "Optional user explanation for their choice"
              },
              "related_observation_id": {
                "type": "string",
                "description": "Links to learning_observations entry if suggestion was based on an observation"
              }
            }
          }
        }
      }
    },
    "update_log": {
      "type": "object",
      "description": "Audit log of all profile changes for transparency and rollback capability",
      "properties": {
        "_comment": {
          "type": "string",
          "description": "Complete history of profile modifications"
        },
        "entries": {
          "type": "array",
          "description": "Individual update log entries",
          "items": {
            "type": "object",
            "required": ["id", "timestamp", "path", "source"],
            "properties": {
              "id": {
                "type": "string",
                "description": "Unique identifier for the log entry"
              },
              "timestamp": {
                "type": "string",
                "description": "ISO 8601 datetime of the change"
              },
              "path": {
                "type": "string",
                "description": "Dot-notation path that was changed"
              },
              "old_value": {
                "description": "Previous value (null if new field)"
              },
              "new_value": {
                "description": "New value after change"
              },
              "source": {
                "type": "string",
                "enum": ["user", "auto_learn", "setup_wizard", "import"],
                "description": "How the change was initiated"
              },
              "reason": {
                "type": "string",
                "description": "Why the change was made"
              },
              "related_observation_id": {
                "type": "string",
                "description": "Links to learning_observations if change was auto-learned"
              }
            }
          }
        }
      }
    }
  },
  "required": ["identity", "time_definitions", "energy_pattern", "roles"]
}
